<!doctype html><html lang="es" data-theme="light"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta name="theme-color" content="#ff6b93" id="metaTheme"/><title>Para mi persona favorita üíò</title><style>:root{--bg:#fff7fb;--text:#1f2430;--card:#ffffff;--muted:#6b7280;--accent:#ff6b93;--accent2:#ff3b3b;--shadow:0 10px 30px rgba(0,0,0,.12);--r:16px;--bg-img:none;--bg-op:.18}*{box-sizing:border-box}html,body{height:100%}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--text);background:radial-gradient(1000px 420px at 50% -220px,rgba(255,107,147,.14),transparent 65%),var(--bg)}body::before{content:"";position:fixed;inset:0;pointer-events:none;z-index:-1;background:var(--bg-img) center/cover no-repeat fixed;opacity:var(--bg-op)}.container{width:min(1080px,92%);margin:auto}header.hero{padding:70px 0 26px;text-align:center}.chip{display:inline-flex;gap:8px;align-items:center;padding:7px 12px;border-radius:999px;background:rgba(255,107,147,.15);font-weight:800;box-shadow:var(--shadow)}.hero h1{margin:8px 0 4px;font-size:clamp(30px,6vw,56px)}.hero p{margin:0;color:var(--muted)}.toolbar{display:flex;gap:10px;justify-content:center;margin-top:16px;flex-wrap:wrap}button{appearance:none;border:none;cursor:pointer;font-weight:800;border-radius:12px;padding:10px 14px;background:linear-gradient(180deg,var(--accent),#ff3b3b);color:#fff;box-shadow:var(--shadow)}button.secondary{background:transparent;color:var(--text);border:1px solid rgba(0,0,0,.15)}section{padding:28px 0}h2{margin:0 0 8px;font-size:clamp(22px,3.5vw,30px)}.grid{display:grid;gap:14px}.grid.auto-fit{grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}.card{background:var(--card);border:1px solid rgba(0,0,0,.12);border-radius:var(--r);padding:16px;box-shadow:var(--shadow)}label{display:flex;align-items:center;justify-content:space-between;gap:8px}input[type=color]{width:28px;height:28px;border:1px solid rgba(0,0,0,.15);border-radius:8px;padding:0;background:var(--card)}.countdown{display:flex;gap:10px;flex-wrap:wrap}.counter{min-width:104px;text-align:center;padding:8px;border-radius:12px;background:var(--card);box-shadow:var(--shadow);border:1px solid rgba(0,0,0,.12)}.counter b{display:block;font-size:40px}.calendar{background:var(--card);border-radius:var(--r);box-shadow:var(--shadow);overflow:hidden;border:1px solid rgba(0,0,0,.12)}.cal-head{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-bottom:1px solid rgba(0,0,0,.12);gap:6px;flex-wrap:wrap}.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background:rgba(0,0,0,.12)}.cal-grid div{background:var(--card);padding:8px;min-height:50px;text-align:center;position:relative}.cal-grid .dow{font-weight:800;background:rgba(255,107,147,.1)}.cal-grid .day.anniv{outline:2px solid rgba(255,59,59,.35);outline-offset:-2px;background:radial-gradient(180px 60px at 50% -20px,rgba(255,107,147,.14),transparent 65%)}.cal-grid .day.anniv::after{content:"üíç";position:absolute;right:6px;top:4px}.cal-grid .day.fourth::before{content:"‚ù§Ô∏è";position:absolute;left:6px;top:4px}.cal-grid .day.today{box-shadow:inset 0 0 0 2px rgba(255,59,59,.35)}.rope{position:relative;height:86px;margin-bottom:6px}.rope::before{content:"";position:absolute;left:0;right:0;top:36px;height:10px;background:repeating-linear-gradient(90deg,#d3a77f,#d3a77f 14px,transparent 14px,transparent 28px)}.gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:22px;align-items:start}.polaroid{position:relative;background:#fff;color:#222;border-radius:12px;padding:8px 8px 28px;box-shadow:0 14px 28px rgba(0,0,0,.14);border:1px solid #eee;transform:rotate(var(--rot,-2deg));transition:.2s}.polaroid:hover{transform:rotate(0) translateY(-2px)}.polaroid img{width:100%;height:172px;object-fit:cover;border-radius:10px}.polaroid small{display:block;text-align:center;color:#7b7b7b;margin-top:6px;padding-bottom:16px}.clip{position:absolute;left:50%;top:-20px;transform:translateX(-50%);width:30px;height:20px;background:#d5b79b;border-radius:6px 6px 2px 2px;box-shadow:0 4px 0 rgba(0,0,0,.15)}.clip::after{content:"";position:absolute;left:7px;right:7px;top:5px;height:8px;background:#c49a73;border-radius:4px}.string{position:absolute;left:50%;top:-20px;width:2px;height:26px;background:linear-gradient(#d3a77f,#b68d67);transform:translateX(-50%)}.tools{position:absolute;left:6px;right:6px;bottom:4px;display:flex;gap:6px;justify-content:center;z-index:3}.tools .sm{padding:4px 6px;font-size:11px;border-radius:8px}.letters .item{border-bottom:1px dashed rgba(0,0,0,.2);padding:8px 0}.bucket li{display:flex;align-items:center;gap:8px;padding:6px 0;border-bottom:1px dashed rgba(0,0,0,.2)}.bucket input[type=checkbox]{accent-color:var(--accent2)}#playlist{width:100%;height:400px;border:0;border-radius:14px;box-shadow:var(--shadow)}.coupons{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}.coupon{border-radius:16px;background:repeating-linear-gradient(45deg,rgba(255,107,147,.12),rgba(255,107,147,.12) 10px,rgba(255,59,59,.12) 10px,rgba(255,59,59,.12) 20px);padding:14px;border:2px dashed rgba(255,59,59,.35)}#heartTrail{position:fixed;inset:0;pointer-events:none;z-index:9999}.heart{position:absolute;width:18px;height:18px;opacity:.95;filter:drop-shadow(0 2px 6px rgba(0,0,0,.25));animation:heartFloat linear forwards}@keyframes heartFloat{from{transform:translate(var(--x,0),0) scale(var(--s,1)) rotate(var(--r,0deg));opacity:1}to{transform:translate(var(--x,0),-120px) scale(calc(var(--s,1) + .15)) rotate(var(--r,0deg));opacity:0}}@media print{body *{visibility:hidden!important}#coupon-section,#coupon-section *{visibility:visible!important}#coupon-section{position:absolute;inset:0;padding:20px}#coupon-section .actions{display:none!important}}</style></head><body><div id="heartTrail"></div><header class="hero"><div class="container"><div class="chip">Para <span id="partnerNameChip">mi amor</span> ‚ú®</div><h1 id="title">Nuestra casita web de amor</h1><p class="lead" id="subtitle">Hecha con detalles tiernos, colores suaves y mucho cari√±o.</p><div class="toolbar"><button id="toggleTheme">üåó Tema</button><button id="toggleHearts" class="secondary">üíñ Corazones</button><button id="openEditor" class="secondary">‚úèÔ∏è Editar</button><button id="printCoupons" class="secondary">üéüÔ∏è Imprimir cupones</button></div></div></header><main class="container"><section class="card"><h2>Tema visual compartido</h2><div class="grid auto-fit"><div><label>Fondo <input type="color" id="pickBg" value="#fff7fb"/></label><label>Texto <input type="color" id="pickText" value="#1f2430"/></label><label>Tarjetas <input type="color" id="pickCard" value="#ffffff"/></label><label>Acento rosa <input type="color" id="pickAccent" value="#ff6b93"/></label><label>Acento rojo <input type="color" id="pickAccent2" value="#ff3b3b"/></label></div><div><div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center"><button class="secondary" id="pickBgImage">Elegir fondo</button><button class="secondary" id="clearBgImage">Quitar fondo</button><button class="secondary" id="resetPalette">Restablecer paleta</button><label>Opacidad <input type="range" id="bgOpacity" min="0" max="100" value="18"/></label></div></div></div></section><section><h2>Nuestro aniversario</h2><div class="grid" style="grid-template-columns:1.2fr 2fr;align-items:start"><div class="card countdown"><div class="counter"><span>Faltan</span><b id="dd">0</b><small>d√≠as</small></div><div class="counter"><span>&nbsp;</span><b id="hh">0</b><small>horas</small></div><div class="counter"><span>&nbsp;</span><b id="mm">0</b><small>minutos</small></div><div class="counter"><span>&nbsp;</span><b id="ss">0</b><small>segundos</small></div></div><div class="card"><div class="calendar"><div class="cal-head"><button id="prevMonth" class="secondary">‚óÄ</button><strong id="calLabel">Mes A√±o</strong><button id="nextMonth" class="secondary">‚ñ∂</button><button id="goToday" class="secondary">Hoy</button></div><div class="cal-grid" id="calGrid"></div></div><div style="margin-top:8px"><button id="gotoAnniv" class="secondary">Ir al mes del aniversario</button></div></div></div></section><section><h2>Timeline de nuestra historia</h2><div class="timeline card" id="timeline"></div><div style="margin-top:8px"><button class="secondary" id="addEvent">‚ûï Agregar evento</button></div></section><section class="reasons"><h2>10 razones por las que te amo</h2><div class="grid auto-fit" id="reasons"></div></section><section><h2>Nuestra galer√≠a</h2><p class="lead">Toc√° una foto para reemplazarla o us√° los botones.</p><input type="file" id="galleryInput" accept="image/*" style="position:fixed;left:-9999px;top:-9999px;width:0;height:0;opacity:0"/><div class="rope" aria-hidden="true"></div><div class="gallery" id="gallery"></div><div style="margin-top:8px"><button id="addPhoto" class="secondary">‚ûï Agregar foto</button></div></section><section><h2>Videos</h2><div class="card"><div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap"><button id="addVideo" class="secondary">‚ûï Agregar video</button><small class="muted">Se reproducen localmente.</small></div><div id="videoList" class="grid auto-fit" style="margin-top:10px"></div></div></section><section class="playlist"><h2>Nuestra playlist</h2><div class="card"><iframe id="playlist" src="" allow="autoplay;clipboard-write;encrypted-media;fullscreen;picture-in-picture" loading="lazy"></iframe></div></section><section class="letters"><h2>Cartas digitales</h2><div class="card"><form id="letterForm" style="display:grid;gap:8px;margin-bottom:8px"><div style="display:flex;gap:8px;flex-wrap:wrap"><input id="letterAuthor" placeholder="Autor/a"/><input id="letterTitle" placeholder="T√≠tulo"/></div><textarea id="letterText" placeholder="Escrib√≠ tu mensaje‚Ä¶" rows="4" required></textarea><div style="display:flex;gap:8px;align-items:center"><button>Guardar carta</button><button type="button" class="secondary" id="clearLetters">Borrar todo</button></div></form><div class="list" id="lettersList"></div></div></section><section><h2>Nuestra historia en palabras</h2><div class="grid auto-fit"><div class="card"><h3>Tu versi√≥n</h3><textarea id="storyMine" rows="5" placeholder="¬øC√≥mo nos conocimos?"></textarea></div><div class="card"><h3>Su versi√≥n</h3><textarea id="storyYours" rows="5" placeholder="Que escriba su parte aqu√≠‚Ä¶"></textarea></div></div><div style="margin-top:8px"><button id="saveStories" class="secondary">üíæ Guardar historias</button></div></section><section><h2>Promesas y metas compartidas</h2><div class="card"><form id="bucketForm" style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px"><input id="bucketInput" placeholder="Agregar meta o plan"/><button>Agregar</button><button type="button" id="clearBucket" class="secondary">Limpiar lista</button></form><ul id="bucketList" class="bucket"></ul></div></section><section><h2>Te extra√±o</h2><div class="card"><div class="grid auto-fit"><div class="card" style="text-align:center"><b>Priii</b><div class="counter" style="margin-top:6px"><b id="missHer">0</b><small>veces</small></div><button id="btnMissHer" class="secondary">Te extra√±o üíó</button></div><div class="card" style="text-align:center"><b>Manuu</b><div class="counter" style="margin-top:6px"><b id="missMe">0</b><small>veces</small></div><button id="btnMissMe" class="secondary">Te extra√±o üíû</button></div></div><div style="margin-top:8px;display:flex;gap:8px;justify-content:center"><button id="resetMiss" class="secondary">Reiniciar contadores</button></div></div></section><section id="coupon-section"><h2>Cupones de amor</h2><div class="coupons" id="coupons"></div></section><section class="card" id="editor" style="position:fixed;top:0;right:0;width:min(520px,100%);height:100%;transform:translateX(100%);transition:.25s;z-index:10000;overflow:auto;padding:14px;border-left:1px solid rgba(0,0,0,.12)"><div style="display:flex;justify-content:space-between;align-items:center;gap:8px"><b>Editor r√°pido</b><div style="display:flex;gap:8px"><button id="saveEditor">Guardar</button><button id="closeEditor" class="secondary">Cerrar</button></div></div><div class="grid auto-fit"><div class="card"><small>Nombres</small><input id="edPartner" placeholder="Nombre de tu pareja"/><input id="edYour" placeholder="Tu nombre"/></div><div class="card"><small>Portada</small><input id="edTitle" placeholder="T√≠tulo"/><input id="edSubtitle" placeholder="Subt√≠tulo"/></div><div class="card"><small>Playlist</small><input id="edPlaylist" placeholder="URL embed de Spotify"/></div><div class="card"><small>Razones</small><div id="edReasons" class="grid auto-fit"></div><button id="edAddReason" class="secondary">+ Raz√≥n</button></div><div class="card"><small>Cupones</small><div id="edCoupons" class="grid auto-fit"></div><button id="edAddCoupon" class="secondary">+ Cup√≥n</button></div><div class="card"><small>Galer√≠a (t√≠tulos)</small><div id="edCaptions" class="grid auto-fit"></div></div></div></section></main><script>const DEFAULT_PALETTE={bg:'#fff7fb',text:'#1f2430',card:'#ffffff',accent:'#ff6b93',accent2:'#ff3b3b'};const DARK_PALETTE={bg:'#0c0a0d',text:'#f5f2f7',card:'#17131b',accent:'#ff6b93',accent2:'#ff3b3b'};const data={partnerName:'Su nombre',title:'Nuestra casita web de amor',subtitle:'Hecha con detalles tiernos, colores suaves y mucho cari√±o.',accent:'#ff6b93',accent2:'#ff3b3b',bg:'#fff7fb',text:'#1f2430',card:'#ffffff',bgImage:'',bgImageOpacity:18,anniversary:'2024-02-04',reasons:['Tu risa ilumina cualquier d√≠a','Me escuch√°s con el coraz√≥n','Tus abrazos son mi refugio','Hac√©s m√°gicos los momentos simples','Admiro tu valent√≠a y tus sue√±os','Tu creatividad me inspira','Somos equipo siempre','Tus detalles y ternura','Tu paciencia y tu forma de cuidarme','Porque con vos todo tiene sentido'],gallery:[{src:'',caption:'Nosotros üíû',rot:-3},{src:'',caption:'Un d√≠a especial',rot:2},{src:'',caption:'Tu sonrisa',rot:-1},{src:'',caption:'Nuestro lugar',rot:4},{src:'',caption:'Un recuerdo lindo',rot:-4}],timeline:[{date:'2023-06-03',title:'Primera salida',note:'Caf√© y mariposas',img:''},{date:'2023-10-15',title:'Oficialmente nosotros',note:'Promesa de cuidarnos',img:''},{date:'2024-01-10',title:'Primer viaje',note:'Fotos y recuerdos',img:''}],playlistSrc:'https://open.spotify.com/embed/playlist/37i9dQZF1DXcCnTAt8CfNe?utm_source=generator',coupons:[{title:'Desayuno a la cama',note:'Caf√© + tostadas + mimos'},{title:'Peli a tu elecci√≥n',note:'Con palomitas y mantita'},{title:'Paseo sorpresa',note:'Yo organizo todo'},{title:'Sesi√≥n de mimos',note:'Duraci√≥n: ilimitada'}]};const partnerNameChip=document.getElementById('partnerNameChip'),titleEl=document.getElementById('title'),subtitleEl=document.getElementById('subtitle');partnerNameChip.textContent=data.partnerName;titleEl.textContent=data.title;subtitleEl.textContent=data.subtitle;const metaTheme=document.getElementById('metaTheme');function applyAccents(){const r=document.documentElement;const isDark=r.getAttribute('data-theme')==='dark';const pal={bg:isDark?DARK_PALETTE.bg:data.bg,text:isDark?DARK_PALETTE.text:data.text,card:isDark?DARK_PALETTE.card:data.card,accent:data.accent,accent2:data.accent2};r.style.setProperty('--bg',pal.bg);r.style.setProperty('--text',pal.text);r.style.setProperty('--card',pal.card);r.style.setProperty('--accent',pal.accent);r.style.setProperty('--accent2',pal.accent2);r.style.setProperty('--bg-img',data.bgImage?`url(${data.bgImage})`:'none');r.style.setProperty('--bg-op',(Number(data.bgImageOpacity)||0)/100);metaTheme.setAttribute('content',pal.accent)}applyAccents();toggleTheme.onclick=()=>{const r=document.documentElement;const next=r.getAttribute('data-theme')==='dark'?'light':'dark';r.setAttribute('data-theme',next);localStorage.setItem('love_theme',next);applyAccents()};(function(){const t=localStorage.getItem('love_theme');if(t)document.documentElement.setAttribute('data-theme',t)})();const pickBg=document.getElementById('pickBg'),pickText=document.getElementById('pickText'),pickCard=document.getElementById('pickCard'),pickA=document.getElementById('pickAccent'),pickB=document.getElementById('pickAccent2'),pickBgImage=document.getElementById('pickBgImage'),clearBgImage=document.getElementById('clearBgImage'),bgOpacity=document.getElementById('bgOpacity'),resetPalette=document.getElementById('resetPalette');pickBg.oninput=()=>{data.bg=pickBg.value;applyAccents();saveLocal()};pickText.oninput=()=>{data.text=pickText.value;applyAccents();saveLocal()};pickCard.oninput=()=>{data.card=pickCard.value;applyAccents();saveLocal()};pickA.oninput=()=>{data.accent=pickA.value;applyAccents();saveLocal()};pickB.oninput=()=>{data.accent2=pickB.value;applyAccents();saveLocal()};bgOpacity.oninput=()=>{data.bgImageOpacity=bgOpacity.value;applyAccents();saveLocal()};pickBgImage.onclick=()=>{const i=document.createElement('input');i.type='file';i.accept='image/*';i.onchange=()=>{const f=i.files[0];if(!f)return;const r=new FileReader();r.onload=()=>{data.bgImage=r.result;applyAccents();saveLocal()};r.readAsDataURL(f)};i.click()};clearBgImage.onclick=()=>{data.bgImage='';applyAccents();saveLocal()};resetPalette.onclick=()=>{Object.assign(data,DEFAULT_PALETTE);applyAccents();pickBg.value=data.bg;pickText.value=data.text;pickCard.value=data.card;pickA.value=data.accent;pickB.value=data.accent2;saveLocal()};function annivParts(){const [,m,d]=data.anniversary.split('-').map(Number);return{m0:m-1,d}}function nextAnniversary(){const a=annivParts(),now=new Date();let t=new Date(now.getFullYear(),a.m0,a.d,0,0,0);if(t<now)t=new Date(now.getFullYear()+1,a.m0,a.d,0,0,0);return t}const dd=document.getElementById('dd'),hh=document.getElementById('hh'),mm=document.getElementById('mm'),ss=document.getElementById('ss');function updateCountdown(){const t=nextAnniversary(),dif=t-new Date(),s=Math.max(0,Math.floor(dif/1000));dd.textContent=Math.floor(s/86400);hh.textContent=Math.floor((s%86400)/3600);mm.textContent=Math.floor((s%3600)/60);ss.textContent=s%60}updateCountdown();setInterval(updateCountdown,1000);const calGrid=document.getElementById('calGrid'),calLabel=document.getElementById('calLabel'),prevBtn=document.getElementById('prevMonth'),nextBtn=document.getElementById('nextMonth'),gotoAnniv=document.getElementById('gotoAnniv'),goToday=document.getElementById('goToday');const A=annivParts();let viewYear=(new Date).getFullYear(),viewMonth=(new Date).getMonth();const DOW=['L','M','X','J','V','S','D'];function renderCalendar(y,m){calGrid.innerHTML='';calLabel.textContent=new Date(y,m,1).toLocaleDateString('es-AR',{month:'long',year:'numeric'});DOW.forEach(d=>{const e=document.createElement('div');e.className='dow';e.textContent=d;calGrid.appendChild(e)});const first=new Date(y,m,1).getDay(),pad=(first+6)%7,days=new Date(y,m+1,0).getDate(),today=new Date();for(let i=0;i<pad;i++){const e=document.createElement('div');e.className='day';e.style.opacity=.2;calGrid.appendChild(e)}for(let d=1;d<=days;d++){const e=document.createElement('div');e.className='day';e.textContent=d;if(d===4)e.classList.add('fourth');if(m===A.m0&&d===A.d)e.classList.add('anniv');if(y===today.getFullYear()&&m===today.getMonth()&&d===today.getDate())e.classList.add('today');calGrid.appendChild(e)}}renderCalendar(viewYear,viewMonth);prevBtn.onclick=()=>{viewMonth--;if(viewMonth<0){viewMonth=11;viewYear--}renderCalendar(viewYear,viewMonth)};nextBtn.onclick=()=>{viewMonth++;if(viewMonth>11){viewMonth=0;viewYear++}renderCalendar(viewYear,viewMonth)};gotoAnniv.onclick=()=>{const now=new Date();viewYear=now.getFullYear();viewMonth=A.m0;renderCalendar(viewYear,viewMonth)};goToday.onclick=()=>{const now=new Date();viewYear=now.getFullYear();viewMonth=now.getMonth();renderCalendar(viewYear,viewMonth)};const timelineEl=document.getElementById('timeline');function renderTimeline(){timelineEl.innerHTML='';[...data.timeline].sort((a,b)=>a.date.localeCompare(b.date)).forEach((it,idx)=>{const row=document.createElement('div');row.className='row';row.style.display='grid';row.style.gridTemplateColumns='120px 1fr';row.style.gap='12px';const left=document.createElement('div');left.style.display='flex';left.style.gap='6px';left.style.alignItems='center';const dot=document.createElement('div');dot.style.cssText='width:10px;height:10px;border-radius:999px;background:var(--accent2);box-shadow:0 0 0 3px rgba(255,59,59,.25)';const date=document.createElement('b');date.textContent=new Date(it.date+'T00:00').toLocaleDateString('es-AR');left.append(dot,date);const card=document.createElement('div');card.className='card';const head=document.createElement('div');head.innerHTML=`<b>${it.title}</b><br><small class='muted'>${it.note||''}</small>`;card.appendChild(head);if(it.img){const im=document.createElement('img');im.src=it.img;im.alt=it.title;im.style.cssText='width:100%;max-height:220px;object-fit:cover;border-radius:10px;margin-top:6px';card.appendChild(im)}const acts=document.createElement('div');acts.style.cssText='display:flex;gap:6px;margin-top:6px;flex-wrap:wrap';if(it.img){const delPhoto=document.createElement('button');delPhoto.className='secondary';delPhoto.textContent='Eliminar foto';delPhoto.onclick=()=>{data.timeline[idx].img='';saveLocal();renderTimeline()};acts.appendChild(delPhoto)}const delEvent=document.createElement('button');delEvent.className='secondary';delEvent.textContent='Eliminar evento';delEvent.onclick=()=>{if(confirm('¬øEliminar este evento?')){data.timeline.splice(idx,1);saveLocal();renderTimeline()}};acts.appendChild(delEvent);card.appendChild(acts);row.append(left,card);timelineEl.appendChild(row)})}renderTimeline();addEvent.onclick=()=>{const when=prompt('Fecha (YYYY-MM-DD)');if(!when)return;const title=prompt('T√≠tulo del evento');if(!title)return;const note=prompt('Nota (opcional)')||'';data.timeline.push({date:when,title,note,img:''});saveLocal();renderTimeline()};const reasonsEl=document.getElementById('reasons');function renderReasons(){reasonsEl.innerHTML='';data.reasons.forEach((t,i)=>{const el=document.createElement('div');el.className='card';el.innerHTML=`<b>#${String(i+1).padStart(2,'0')}</b><br>${t}`;reasonsEl.appendChild(el)})}renderReasons();const gallery=document.getElementById('gallery'),gi=document.getElementById('galleryInput');function fileToDataURL(f){return new Promise((res,rej)=>{const r=new FileReader();r.onload=()=>res(r.result);r.onerror=rej;r.readAsDataURL(f)})}function placeholderData(){const svg=encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'><rect width='100%' height='100%' fill='#f8f8f8'/><g transform='translate(100,90)'><path d='M0 20 C-40 -30 -90 0 -60 35 C-10 90 0 95 0 95 C0 95 10 90 60 35 C90 0 40 -30 0 20' fill='#ff8faf'/></g></svg>`);return `data:image/svg+xml;charset=utf-8,${svg}`}function renderGallery(){gallery.innerHTML='';data.gallery.forEach((g,idx)=>{const card=document.createElement('div');card.className='polaroid';card.style.setProperty('--rot',(g.rot||0)+'deg');const string=document.createElement('div');string.className='string';const clip=document.createElement('div');clip.className='clip';const img=document.createElement('img');img.alt=`Foto ${idx+1}`;img.src=g.src||placeholderData();const small=document.createElement('small');small.textContent=g.caption||'';const tools=document.createElement('div');tools.className='tools';const btnR=document.createElement('button');btnR.className='secondary sm';btnR.textContent='üì∑ Reemplazar';const btnD=document.createElement('button');btnD.className='secondary sm';btnD.textContent='üóëÔ∏è Eliminar';const doReplace=()=>{gi.value='';const once=async()=>{const f=gi.files&&gi.files[0];gi.removeEventListener('change',once);if(!f)return;let url=null;try{url=await fileToDataURL(f)}catch(_){url=URL.createObjectURL(f)}data.gallery[idx].src=url;saveLocal();renderGallery();if(typeof buildEditor==='function')buildEditor()};gi.addEventListener('change',once,{once:true});gi.click()};btnR.onclick=(e)=>{e.stopPropagation();doReplace()};btnD.onclick=(e)=>{e.stopPropagation();data.gallery.splice(idx,1);saveLocal();renderGallery();if(typeof buildEditor==='function')buildEditor()};card.onclick=()=>doReplace();img.onclick=(e)=>{e.stopPropagation();doReplace()};tools.append(btnR,btnD);card.append(string,clip,img,small,tools);gallery.appendChild(card)})}renderGallery();addPhoto.onclick=()=>{gi.value='';const once=async()=>{const f=gi.files&&gi.files[0];gi.removeEventListener('change',once);if(!f)return;let url=null;try{url=await fileToDataURL(f)}catch(_){url=URL.createObjectURL(f)}const cap=prompt('T√≠tulo o nota para la foto (opcional)','')||'';const rot=[-4,-3,-2,2,3,4][Math.floor(Math.random()*6)];data.gallery.push({src:url,caption:cap,rot});saveLocal();renderGallery();if(typeof buildEditor==='function')buildEditor()};gi.addEventListener('change',once,{once:true});gi.click()};addVideo.onclick=()=>{const i=document.createElement('input');i.type='file';i.accept='video/mp4,video/webm';i.onchange=()=>{const f=i.files[0];if(!f)return;const url=URL.createObjectURL(f),wrap=document.createElement('div');wrap.className='card';wrap.innerHTML=`<video controls style='width:100%;border-radius:12px'><source src='${url}' type='${f.type}'/></video><small class='muted'>${f.name}</small>`;videoList.prepend(wrap)};i.click()};playlist.src=data.playlistSrc;const letterForm=document.getElementById('letterForm'),lettersList=document.getElementById('lettersList');function loadLetters(){try{return JSON.parse(localStorage.getItem('love_letters_v1')||'[]')}catch(e){return[]}}function saveLetters(x){localStorage.setItem('love_letters_v1',JSON.stringify(x))}function escapeHTML(s){return(s||'').replace(/[&<>"']/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c]))}function renderLetters(){const items=loadLetters();lettersList.innerHTML=items.length?'':'<small class="muted">A√∫n no hay cartas.</small>';items.forEach(it=>{const d=document.createElement('div');d.className='item';const date=new Date(it.ts).toLocaleString('es-AR');d.innerHTML=`<b>${escapeHTML(it.title)||'Carta'}</b> <small class='muted'>‚Ä¢ ${escapeHTML(it.author)||'An√≥nimo'} ‚Ä¢ ${date}</small><p style='margin:.25rem 0 0'>${escapeHTML(it.text)}</p>`;lettersList.prepend(d)})}letterForm.onsubmit=e=>{e.preventDefault();const it={author:letterAuthor.value.trim(),title:letterTitle.value.trim(),text:letterText.value.trim(),ts:Date.now()};if(!it.text)return;const arr=loadLetters();arr.push(it);saveLetters(arr);letterForm.reset();renderLetters()};clearLetters.onclick=()=>{if(confirm('¬øBorrar todas las cartas?')){saveLetters([]);renderLetters()}};renderLetters();(function(){try{const s=JSON.parse(localStorage.getItem('love_stories_v1')||'{}');storyMine.value=s.mine||'';storyYours.value=s.yours||''}catch(e){}})();saveStories.onclick=()=>{localStorage.setItem('love_stories_v1',JSON.stringify({mine:storyMine.value,yours:storyYours.value}));alert('Historias guardadas üíæ')};const bucketForm=document.getElementById('bucketForm'),bucketInput=document.getElementById('bucketInput'),bucketList=document.getElementById('bucketList');function loadBucket(){try{return JSON.parse(localStorage.getItem('love_bucket_v1')||'[]')}catch(e){return[]}}function saveBucket(x){localStorage.setItem('love_bucket_v1',JSON.stringify(x))}function renderBucket(){bucketList.innerHTML='';loadBucket().forEach((it,idx)=>{const li=document.createElement('li');li.innerHTML=`<input type='checkbox' ${it.done?'checked':''} data-idx='${idx}'/> <span ${it.done?"style='text-decoration:line-through'":''}>${escapeHTML(it.text)}</span> <button class='secondary' data-del='${idx}'>Eliminar</button>`;bucketList.appendChild(li)});bucketList.querySelectorAll('input[type=checkbox]').forEach(cb=>cb.onchange=()=>{const arr=loadBucket(),i=Number(cb.getAttribute('data-idx'));arr[i].done=cb.checked;saveBucket(arr);renderBucket()});bucketList.querySelectorAll('button[data-del]').forEach(btn=>btn.onclick=()=>{const i=Number(btn.getAttribute('data-del')),arr=loadBucket();arr.splice(i,1);saveBucket(arr);renderBucket()})}bucketForm.onsubmit=e=>{e.preventDefault();const t=bucketInput.value.trim();if(!t)return;const arr=loadBucket();arr.push({text:t,done:false});saveBucket(arr);bucketInput.value='';renderBucket()};clearBucket.onclick=()=>{if(confirm('¬øVaciar la lista?')){saveBucket([]);renderBucket()}};renderBucket();const coupons=document.getElementById('coupons');function renderCoupons(){coupons.innerHTML='';data.coupons.forEach((c,i)=>{const el=document.createElement('div');el.className='coupon card';el.innerHTML=`<h3>${escapeHTML(c.title)}</h3><small class='muted'>${escapeHTML(c.note||'')}</small><div class='actions' style='display:flex;gap:8px;margin-top:8px'><button class='secondary' data-idx='${i}'>Descargar PNG</button></div>`;coupons.appendChild(el)});coupons.querySelectorAll('button[data-idx]').forEach(btn=>btn.onclick=async()=>{const idx=Number(btn.getAttribute('data-idx')),url=await couponAsPNG(data.coupons[idx]);const a=document.createElement('a');a.href=url;a.download=(data.coupons[idx].title||'cupon')+'.png';a.click();URL.revokeObjectURL(url)})}function couponAsPNG(c){const W=1400,H=660,canvas=Object.assign(document.createElement('canvas'),{width:W,height:H}),ctx=canvas.getContext('2d');const g=ctx.createLinearGradient(0,0,W,H);g.addColorStop(0,'#fff0f5');g.addColorStop(1,'#ffe0e7');ctx.fillStyle=g;ctx.fillRect(0,0,W,H);ctx.globalAlpha=0.08;ctx.strokeStyle='#ff9bb3';ctx.lineWidth=1;for(let x=-H;x<W+H;x+=22){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x-H,H);ctx.stroke()}ctx.globalAlpha=1;const P=26;ctx.fillStyle='#ffffff';roundRect(ctx,P,P,W-2*P,H-2*P,28);ctx.fill();ctx.save();ctx.strokeStyle='#ff6b93';ctx.lineWidth=6;ctx.setLineDash([18,12]);roundRect(ctx,P+8,P+8,W-2*(P+8),H-2*(P+8),24);ctx.stroke();ctx.restore();ctx.globalAlpha=0.06;drawHeart(ctx,W/2,H/2-10,280,'#ff6b93');ctx.globalAlpha=1;const ribbonY=190,ribbonH=110;ctx.fillStyle='#ff6b93';roundRect(ctx,P+70,ribbonY,W-2*(P+70),ribbonH,18);ctx.fill();drawHeart(ctx,P+80,P+80,64,'#ff6b93');drawHeart(ctx,W-P-80,P+80,48,'#ff3b3b');ctx.fillStyle='#ffffff';let title=(c.title||'Cup√≥n de amor');let f=78;const maxW=W-2*(P+120);do{ctx.font='bold '+f+'px system-ui, sans-serif'}while(ctx.measureText(title).width>maxW&&(f-=2)>36);ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillText(title,W/2,ribbonY+ribbonH/2);ctx.fillStyle='#6b7280';const note=c.note||'';if(note){const lines=wrapText(ctx,note,maxW,28,'600 28px system-ui, sans-serif');let y=ribbonY+ribbonH+40;lines.forEach(line=>{ctx.font='600 28px system-ui, sans-serif';ctx.fillText(line,W/2,y);y+=36})}ctx.fillStyle='#444';ctx.font='22px system-ui, sans-serif';ctx.fillText(`V√°lido por un (1) uso ‚Ä¢ ${new Date().toLocaleDateString('es-AR')}`,W/2,H-60);return new Promise(res=>canvas.toBlob(b=>res(URL.createObjectURL(b)),'image/png'));function wrapText(ctx,text,maxWidth,minSize,font){ctx.font=font;const words=text.split(' ');const lines=[];let line='';for(const w of words){const test=line?line+' '+w:w;if(ctx.measureText(test).width>maxWidth){if(line)lines.push(line);line=w}else{line=test}}if(line)lines.push(line);return lines.slice(0,3)}}renderCoupons();printCoupons.onclick=()=>window.print();const MISSKEY='love_miss_v1';function loadMiss(){try{return JSON.parse(localStorage.getItem(MISSKEY)||'{}')}catch(e){return{}}}function saveMiss(x){localStorage.setItem(MISSKEY,JSON.stringify(x))}const miss=Object.assign({her:0,me:0},loadMiss());const missHer=document.getElementById('missHer'),missMe=document.getElementById('missMe');function renderMiss(){missHer.textContent=miss.her;missMe.textContent=miss.me}renderMiss();btnMissHer.onclick=()=>{miss.her++;saveMiss(miss);renderMiss()};btnMissMe.onclick=()=>{miss.me++;saveMiss(miss);renderMiss()};resetMiss.onclick=()=>{if(confirm('¬øReiniciar contadores?')){miss.her=0;miss.me=0;saveMiss(miss);renderMiss()}};openEditor.onclick=()=>{buildEditor();editor.style.transform='translateX(0)'};closeEditor.onclick=()=>{editor.style.transform='translateX(100%)'};saveEditor.onclick=()=>{data.partnerName=edPartner.value.trim()||data.partnerName;data.title=edTitle.value.trim()||data.title;data.subtitle=edSubtitle.value.trim()||data.subtitle;data.playlistSrc=edPlaylist.value.trim()||data.playlistSrc;data.reasons=[...document.querySelectorAll('#edReasons input')].map(i=>i.value.trim()).filter(Boolean);data.coupons=[...document.querySelectorAll('#edCoupons .item')].map(it=>({title:it.querySelector('.t').value.trim(),note:it.querySelector('.n').value.trim()})).filter(o=>o.title||o.note);data.gallery.forEach((g,i)=>{const v=document.getElementById('cap'+i);if(v)g.caption=v.value});applyAccents();partnerNameChip.textContent=data.partnerName;titleEl.textContent=data.title;subtitleEl.textContent=data.subtitle;playlist.src=data.playlistSrc;renderReasons();renderGallery();renderCoupons();saveLocal();editor.style.transform='translateX(100%)'};function buildEditor(){edPartner.value=data.partnerName||'';edTitle.value=data.title||'';edSubtitle.value=data.subtitle||'';edPlaylist.value=data.playlistSrc||'';const R=edReasons;R.innerHTML='';data.reasons.forEach((v,i)=>{const d=document.createElement('div');d.className='card';d.innerHTML=`<input value="${v.replace(/"/g,'&quot;')}"/><button class='secondary' data-i='${i}'>Eliminar</button>`;R.appendChild(d)});R.querySelectorAll('button[data-i]').forEach(b=>b.onclick=()=>{const i=Number(b.getAttribute('data-i'));data.reasons.splice(i,1);buildEditor()});edAddReason.onclick=()=>{data.reasons.push('Nueva raz√≥n');buildEditor()};const C=edCoupons;C.innerHTML='';data.coupons.forEach((c,i)=>{const d=document.createElement('div');d.className='card item';d.innerHTML=`<input class='t' placeholder='T√≠tulo' value="${(c.title||'').replace(/"/g,'&quot;')}"><input class='n' placeholder='Nota' value="${(c.note||'').replace(/"/g,'&quot;')}"><button class='secondary' data-i='${i}'>Eliminar</button>`;C.appendChild(d)});C.querySelectorAll('button[data-i]').forEach(b=>b.onclick=()=>{const i=Number(b.getAttribute('data-i'));data.coupons.splice(i,1);buildEditor()});edAddCoupon.onclick=()=>{data.coupons.push({title:'Nuevo cup√≥n',note:''});buildEditor()};const G=edCaptions;G.innerHTML='';data.gallery.forEach((g,i)=>{const d=document.createElement('div');d.className='card';d.innerHTML=`<small>Foto ${i+1}</small><input id='cap${i}' value="${(g.caption||'').replace(/"/g,'&quot;')}">`;G.appendChild(d)})}document.addEventListener('keydown',e=>{if(e.key==='Escape')editor.style.transform='translateX(100%)'});const LSKEY='love_data_pwa_final';function saveLocal(){try{localStorage.setItem(LSKEY,JSON.stringify(data))}catch(e){}}(function(){try{const s=JSON.parse(localStorage.getItem(LSKEY)||'null');if(s){Object.assign(data,s);applyAccents();partnerNameChip.textContent=data.partnerName;titleEl.textContent=data.title;subtitleEl.textContent=data.subtitle;pickBg.value=data.bg;pickText.value=data.text;pickCard.value=data.card;pickA.value=data.accent;pickB.value=data.accent2;bgOpacity.value=Number(data.bgImageOpacity)||18;playlist.src=data.playlistSrc;renderReasons();renderGallery();renderTimeline()}}catch(e){}})();const heartTrail=document.getElementById('heartTrail'),heartsBtn=document.getElementById('toggleHearts');let heartsOn=false,lastSpawn=0;const HEARTS=['#ff3b3b','#ff6b93','#ff3366','#ff6f6f','#ff4d6d'];function heartSVG(t,c){const p={classic:`<path d="M10 30 C10 15 25 10 32 20 C39 10 54 15 54 30 C54 50 32 58 32 58 C32 58 10 50 10 30" fill="${c}"/>`,puff:`<path d="M16 32 C10 18 28 8 34 18 C40 8 58 18 52 32 C48 42 34 54 34 54 C34 54 20 42 16 32" fill="${c}"/>`};return `<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'>${p[t]}</svg>`}function spawnHeartAt(x,y){if(!heartsOn)return;const now=performance.now();if(now-lastSpawn<26)return;lastSpawn=now;const el=document.createElement('img');el.className='heart';const type=['classic','puff'][Math.floor(Math.random()*2)],color=HEARTS[Math.floor(Math.random()*HEARTS.length)],svg=heartSVG(type,color);el.src='data:image/svg+xml;charset=utf-8,'+encodeURIComponent(svg);const size=12+Math.random()*16;el.style.width=el.style.height=size+'px';const dx=(Math.random()*40-20),rot=(Math.random()*40-20)+'deg',scale=(0.9+Math.random()*0.4).toFixed(2);el.style.setProperty('--x',dx+'px');el.style.setProperty('--r',rot);el.style.setProperty('--s',scale);el.style.left=(x-size/2)+'px';el.style.top=(y-size/2)+'px';const dur=900+Math.random()*900;el.style.animationDuration=dur+'ms';heartTrail.appendChild(el);setTimeout(()=>el.remove(),dur+80)}document.addEventListener('mousemove',e=>spawnHeartAt(e.clientX,e.clientY));heartsBtn.onclick=()=>{heartsOn=!heartsOn;heartsBtn.textContent=heartsOn?'üíñ Corazones: ON':'üíñ Corazones'};</script></body></html>
